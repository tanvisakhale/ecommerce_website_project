<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cart - E-Shop</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-light bg-light">
  <div class="container">
    <a class="navbar-brand" href="index.html">E-Shop</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav ms-auto align-items-center">
        <li class="nav-item"><a class="nav-link" href="products.html">Products</a></li>
        <li class="nav-item"><a class="nav-link" href="category.html">Categories</a></li>
        <li class="nav-item"><a class="nav-link" href="about.html">About Us</a></li>
        <li class="nav-item"><a class="nav-link" href="contact.html">Contact</a></li>
      </ul>
      <form class="d-flex ms-3" role="search" action="products.html" method="get" style="max-width:250px;">
        <input class="form-control form-control-sm me-2" type="search" name="q" placeholder="Search products..." aria-label="Search">
        <button class="btn btn-outline-primary btn-sm" type="submit" aria-label="Search"><i class="bi bi-search"></i></button>
      </form>
      <a class="nav-link px-2 ms-2" href="cart.html" aria-label="Cart" title="Cart">
        <i class="bi bi-cart3 fs-5"></i>
      </a>
    </div>
  </div>
</nav>

<section class="py-5">
  <div class="container">
    <div class="row">
      <div class="col-lg-8">
        <h2 class="mb-4">Your Shopping Cart</h2>
        
        <!-- Empty Cart State -->
        <div id="emptyCart" class="text-center py-5" style="display: none;">
          <i class="bi bi-cart-x display-1 text-muted"></i>
          <h4 class="mt-3">Your cart is empty</h4>
          <p class="text-muted">Looks like you haven't added any items to your cart yet.</p>
          <a href="products.html" class="btn btn-primary">
            <i class="bi bi-arrow-left"></i> Continue Shopping
          </a>
        </div>
        
        <!-- Cart Items -->
        <div id="cartItems">
          <div class="table-responsive">
            <table class="table table-bordered">
              <thead>
                <tr>
                  <th>Product</th>
                  <th>Price</th>
                  <th>Quantity</th>
                  <th>Total</th>
                  <th>Action</th>
                </tr>
              </thead>
              <tbody id="cartTableBody">
                <!-- Cart items will be loaded here by JavaScript -->
              </tbody>
            </table>
          </div>
        </div>
      </div>
      
      <!-- Cart Summary -->
      <div class="col-lg-4">
        <div class="card">
          <div class="card-header">
            <h5 class="mb-0">Order Summary</h5>
          </div>
          <div class="card-body">
            <div class="d-flex justify-content-between mb-2">
              <span>Subtotal:</span>
              <span id="subtotal">₹0.00</span>
            </div>
            <div class="d-flex justify-content-between mb-2">
              <span>Shipping:</span>
              <span id="shipping">₹0.00</span>
            </div>
            <div class="d-flex justify-content-between mb-2">
              <span>Tax:</span>
              <span id="tax">₹0.00</span>
            </div>
            <hr>
            <div class="d-flex justify-content-between mb-3">
              <strong>Total:</strong>
              <strong id="total">₹0.00</strong>
            </div>
            
            <button class="btn btn-primary w-100 mb-2" onclick="proceedToCheckout()" id="checkoutBtn" disabled>
              <i class="bi bi-credit-card"></i> Proceed to Checkout
            </button>
            
            <a href="products.html" class="btn btn-outline-secondary w-100">
              <i class="bi bi-arrow-left"></i> Continue Shopping
            </a>
          </div>
        </div>
        
        <!-- Promo Code -->
        <div class="card mt-3">
          <div class="card-body">
            <h6>Have a promo code?</h6>
            <div class="input-group">
              <input type="text" class="form-control" id="promoCode" placeholder="Enter code">
              <button class="btn btn-outline-primary" type="button" onclick="applyPromoCode()">Apply</button>
            </div>
            <small class="text-muted">Try: SAVE10, FREESHIP</small>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<footer class="bg-dark text-white py-4">
  <div class="container text-center">
    <p>&copy; TANVI SAKHALE 2025 E-Shop. All rights reserved.</p>
    <p>
      <a href="about.html" class="text-white">About Us</a> |
      <a href="contact.html" class="text-white">Contact</a>
    </p>
  </div>
</footer>

<!-- Scroll to Top -->
<button id="scrollTopBtn" class="btn btn-primary position-fixed d-none" style="bottom:20px;right:20px;z-index:1000;">↑</button>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="js/script.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
<script>
  // Show scroll-to-top button only when scrolling down
  const scrollBtn = document.getElementById('scrollTopBtn');
  window.onscroll = function() {
    if (document.body.scrollTop > 200 || document.documentElement.scrollTop > 200) {
      scrollBtn.classList.remove('d-none');
    } else {
      scrollBtn.classList.add('d-none');
    }
  };
  scrollBtn.onclick = function() {
    window.scrollTo({top:0,behavior:'smooth'});
  };
  
  // Cart page specific functionality
  let appliedPromoCode = null;
  
  document.addEventListener('DOMContentLoaded', function() {
    updateCartDisplay();
    updateOrderSummary();
  });
  
  // Override updateCartDisplay for cart page
  function updateCartDisplay() {
    const cartTableBody = document.getElementById('cartTableBody');
    const emptyCart = document.getElementById('emptyCart');
    const cartItems = document.getElementById('cartItems');
    const checkoutBtn = document.getElementById('checkoutBtn');
    
    if (cart.length === 0) {
      emptyCart.style.display = 'block';
      cartItems.style.display = 'none';
      checkoutBtn.disabled = true;
    } else {
      emptyCart.style.display = 'none';
      cartItems.style.display = 'block';
      checkoutBtn.disabled = false;
      
      cartTableBody.innerHTML = '';
      cart.forEach(item => {
        const row = document.createElement('tr');
        const itemTotal = item.price * item.quantity;
        
        row.innerHTML = `
          <td>
            <div class="d-flex align-items-center">
              <img src="${item.image}" alt="${item.name}" style="width: 50px; height: 50px; object-fit: cover;" class="me-3">
              <div>
                <h6 class="mb-0">${item.name}</h6>
                <small class="text-muted">${item.category}</small>
              </div>
            </div>
          </td>
          <td>₹${item.price.toFixed(2)}</td>
          <td>
            <div class="input-group" style="width: 120px;">
              <button class="btn btn-outline-secondary btn-sm" onclick="updateQuantity(${item.id}, ${item.quantity - 1})">-</button>
              <input type="number" value="${item.quantity}" min="1" class="form-control text-center" onchange="updateQuantity(${item.id}, this.value)">
              <button class="btn btn-outline-secondary btn-sm" onclick="updateQuantity(${item.id}, ${item.quantity + 1})">+</button>
            </div>
          </td>
          <td class="fw-bold">₹${itemTotal.toFixed(2)}</td>
          <td>
            <button class="btn btn-danger btn-sm" onclick="removeFromCart(${item.id})">
              <i class="bi bi-trash"></i>
            </button>
          </td>
        `;
        cartTableBody.appendChild(row);
      });
    }
  }
  
  function updateOrderSummary() {
    const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
    const shipping = subtotal > 500 ? 0 : 50;
    const tax = subtotal * 0.08; // 8% tax
    let total = subtotal + shipping + tax;
    
    // Apply promo code discount
    if (appliedPromoCode) {
      if (appliedPromoCode === 'SAVE10') {
        total = total * 0.9; // 10% discount
      } else if (appliedPromoCode === 'FREESHIP') {
        total = total - shipping;
      }
    }
    
    document.getElementById('subtotal').textContent = `₹${subtotal.toFixed(2)}`;
    document.getElementById('shipping').textContent = shipping === 0 ? 'FREE' : `₹${shipping.toFixed(2)}`;
    document.getElementById('tax').textContent = `₹${tax.toFixed(2)}`;
    document.getElementById('total').textContent = `₹${total.toFixed(2)}`;
  }
  
  function applyPromoCode() {
    const promoCode = document.getElementById('promoCode').value.toUpperCase();
    const validCodes = ['SAVE10', 'FREESHIP'];
    
    if (validCodes.includes(promoCode)) {
      appliedPromoCode = promoCode;
      showNotification(`Promo code "${promoCode}" applied successfully!`, 'success');
      updateOrderSummary();
    } else {
      showNotification('Invalid promo code. Please try again.', 'error');
    }
  }
  
  function proceedToCheckout() {
    if (cart.length === 0) {
      showNotification('Your cart is empty!', 'error');
      return;
    }
    window.location.href = 'checkout.html';
  }
  
  // Override removeFromCart to update summary
  const originalRemoveFromCart = window.removeFromCart;
  window.removeFromCart = function(productId) {
    originalRemoveFromCart(productId);
    updateOrderSummary();
  };
  
  // Override updateQuantity to update summary
  const originalUpdateQuantity = window.updateQuantity;
  window.updateQuantity = function(productId, newQuantity) {
    originalUpdateQuantity(productId, newQuantity);
    updateOrderSummary();
  };
</script>
</body>
</html>